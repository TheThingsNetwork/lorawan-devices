function decodeUplink(input) {\n return { \n data: Decode(input.fPort, input.bytes, input.variables)\n }; \n}\nfunction datalog(i,bytes){\n var aa=(bytes[0+i]&0x08)?\"PART\":\"SUM\";\n var bb=(bytes[0+i]&0x04)?\"YES\":\"NO\"; \n var cc=(bytes[0+i]&0x02)?\"TRUE\":\"FALSE\"; \n var dd=(bytes[0+i]&0x01)?\"OPEN\":\"CLOSE\"; \n var ee=(bytes[1+i]<<16 | bytes[2+i]<<8 | bytes[3+i]).toString(10);\n var ff=(bytes[4+i]<<16 | bytes[5+i]<<8 | bytes[6+i]).toString(10);\n var gg= getMyDate((bytes[7+i]<<24 | bytes[8+i]<<16 | bytes[9+i]<<8 | bytes[10+i]).toString(10));\n var string='['+aa+','+bb+','+cc+','+dd+','+ee+','+ff+','+gg+']'+','; \n \n return string;\n}\n\nfunction getzf(c_num){ \n if(parseInt(c_num) < 10)\n c_num = '0' + c_num; \n\n return c_num; \n}\n\nfunction getMyDate(str){ \n var c_Date;\n if(str > 9999999999)\n c_Date = new Date(parseInt(str));\n else \n c_Date = new Date(parseInt(str) * 1000);\n \n var c_Year = c_Date.getFullYear(), \n c_Month = c_Date.getMonth()+1, \n c_Day = c_Date.getDate(),\n c_Hour = c_Date.getHours(), \n c_Min = c_Date.getMinutes(), \n c_Sen = c_Date.getSeconds();\n var c_Time = c_Year +'-'+ getzf(c_Month) +'-'+ getzf(c_Day) +' '+ getzf(c_Hour) +':'+ getzf(c_Min) +':'+getzf(c_Sen); \n \n return c_Time;\n}\n\nfunction Decode(fPort, bytes, variables) {\n if(fPort==0x03)\n {\n var pnack= ((bytes[0]>>7)&0x01) ? \"True\":\"False\"; \n for(var i=0;i<bytes.length;i=i+11)\n {\n var data= datalog(i,bytes);\n if(i=='0')\n data_sum=data;\n else\n data_sum+=data;\n }\n return{\n DATALOG:data_sum,\n PNACKMD:pnack,\n };\n }\n else if(fPort==0x04)\n {\n var tdc= bytes[0]<<16 | bytes[1]<<8 | bytes[2];\n var disalarm= bytes[3]&0x01;\n var keep_status1= bytes[4]&0x01;\n var keep_time1= bytes[5]<<8 | bytes[6];\n var keep_status2= bytes[7]&0x01;\n var keep_time2= bytes[8]<<8 | bytes[9];\n var alarm_tdc= bytes[10];\n \n return {\n tdc:tdc,\n disalarm:disalarm,\n keep_status1:keep_status1,\n keep_time1:keep_time1,\n keep_status2:keep_status2,\n keep_time2:keep_time2,\n alarm_tdc:alarm_tdc\n };\n }\n else if(fPort==0x05)\n {\n var sub_band;\n var freq_band;\n var sensor;\n \n if(bytes[0]==0x1B)\n sensor= \"DS03A-LB\";\n \n if(bytes[4]==0xff)\n sub_band=\"NULL\";\n else\n sub_band=bytes[4];\n \n if(bytes[3]==0x01)\n freq_band=\"EU868\";\n else if(bytes[3]==0x02)\n freq_band=\"US915\";\n else if(bytes[3]==0x03)\n freq_band=\"IN865\";\n else if(bytes[3]==0x04)\n freq_band=\"AU915\";\n else if(bytes[3]==0x05)\n freq_band=\"KZ865\";\n else if(bytes[3]==0x06)\n freq_band=\"RU864\";\n else if(bytes[3]==0x07)\n freq_band=\"AS923\";\n else if(bytes[3]==0x08)\n freq_band=\"AS923_1\";\n else if(bytes[3]==0x09)\n freq_band=\"AS923_2\";\n else if(bytes[3]==0x0A)\n freq_band=\"AS923_3\";\n else if(bytes[3]==0x0B)\n freq_band=\"CN470\";\n else if(bytes[3]==0x0C)\n freq_band=\"EU433\";\n else if(bytes[3]==0x0D)\n freq_band=\"KR920\";\n else if(bytes[3]==0x0E)\n freq_band=\"MA869\";\n \n var firm_ver= (bytes[1]&0x0f)+'.'+(bytes[2]>>4&0x0f)+'.'+(bytes[2]&0x0f);\n var bat= (bytes[5]<<8 | bytes[6])/1000;\n \n return {\n SENSOR_MODEL:sensor,\n FIRMWARE_VERSION:firm_ver,\n FREQUENCY_BAND:freq_band,\n SUB_BAND:sub_band,\n battery:bat,\n };\n }\n else\n { \n var count_mod=(bytes[0]&0x08)?\"PART\":\"SUM\"; \n var tdc_interval=(bytes[0]&0x04)?\"YES\":\"NO\"; \n var alarm1=(bytes[0]&0x02)?\"TRUE\":\"FALSE\"; \n var door1_open_status=(bytes[0]&0x01)?\"OPEN\":\"CLOSE\"; \n var open1_times=bytes[1]<<16 | bytes[2]<<8 | bytes[3];\n var open1_duration=bytes[4]<<16 | bytes[5]<<8 | bytes[6];\n var alarm2=(bytes[11]&0x02)?\"TRUE\":\"FALSE\"; \n var door2_open_status=(bytes[11]&0x01)?\"OPEN\":\"CLOSE\"; \n var open2_times=bytes[12]<<16 | bytes[13]<<8 | bytes[14];\n var open2_duration=bytes[15]<<16 | bytes[16]<<8 | bytes[17]; \n var data_time= getMyDate((bytes[7]<<24 | bytes[8]<<16 | bytes[9]<<8 | bytes[10]).toString(10));\n \n if(bytes.length==11)\n {\n return {\n count_mod:count_mod, \n tdc:tdc_interval, \n alarm1:alarm1,\n door1_open_status:door1_open_status,\n door1_open_times:open1_times,\n last_door1_open_duration:open1_duration,\n time:data_time\n };\n }\n else if(bytes.length==18)\n {\n return {\n count_mod:count_mod, \n tdc:tdc_interval, \n alarm1:alarm1,\n door1_open_status:door1_open_status,\n door1_open_times:open1_times,\n last_door1_open_duration:open1_duration,\n alarm2:alarm2,\n door2_open_status:door2_open_status,\n door2_open_times:open2_times,\n last_door2_open_duration:open2_duration, \n time:data_time\n };\n } \n }\n}