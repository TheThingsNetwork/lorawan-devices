# Uplink decoder decodes binary data uplink into a JSON object (optional)
# For documentation on writing encoders and decoders, see: https://www.thethingsindustries.com/docs/integrations/payload-formatters/javascript/
uplinkDecoder:
  fileName: lkm-lw-2404.js

  # based on following payload
  #10 00036FFE 02 61703B0F 020201 4C4F52415F4C575F534552564552
  examples:
    - description: LKM LW example frame decode - Status
      input:
        fPort: 1
        bytes: [0x00, 0x03, 0x6F, 0xB8, 0x00, 0x01, 0x18, 0x03, 0x63, 0xCF, 0x46, 0x24, 0x02, 0x03, 0x01, 0x4C, 0x4B, 0x4D, 0x5F, 0x4C, 0x57, 0x5F, 0x53, 0x45, 0x52, 0x56, 0x45, 0x52]

      output:
        data:
          deviceID: 225208
          deviceName: 'LKM_LW_SERVER'
          deviceTime: '2024-4-30 15:24:36'
          firmwareVersion: '2.3.1'
          frameCounter: 0
          frameType: 'Status Message - Device'
          meterQty: 1
          obisQty: 24
          targetPort: 3

    - description: LKM LW example frame decode - OBIS Codes
      input:
        fPort: 2
        bytes:
          [
            0x00,
            0x03,
            0x6F,
            0xB8,
            0x01,
            0x01,
            0x1F,
            0x46,
            0x2E,
            0x46,
            0x2A,
            0x1F,
            0x02,
            0x1F,
            0x30,
            0x2E,
            0x39,
            0x2E,
            0x31,
            0x2A,
            0x1F,
            0x03,
            0x1F,
            0x30,
            0x2E,
            0x39,
            0x2E,
            0x32,
            0x2A,
            0x1F,
            0x04,
            0x1F,
            0x31,
            0x2E,
            0x38,
            0x2E,
            0x30,
            0x2A,
            0x1F,
            0x05,
            0x1F,
            0x31,
            0x2E,
            0x38,
            0x2E,
            0x31,
            0x2A,
            0x1F,
            0x06,
            0x1F,
            0x31,
            0x2E,
            0x38,
            0x2E,
            0x32,
            0x2A,
            0x1F,
            0x07,
            0x1F,
            0x31,
            0x2E,
            0x38,
            0x2E,
            0x33,
            0x2A,
            0x1F,
            0x08,
            0x1F,
            0x32,
            0x2E,
            0x38,
            0x2E,
            0x30,
            0x2A,
            0x1F,
            0x09,
            0x1F,
            0x32,
            0x2E,
            0x38,
            0x2E,
            0x31,
            0x2A,
            0x1F,
            0x0A,
            0x1F,
            0x32,
            0x2E,
            0x38,
            0x2E,
            0x32,
            0x2A,
            0x1F,
            0x0B,
            0x1F,
            0x32,
            0x2E,
            0x38,
            0x2E,
            0x33,
            0x2A,
            0x1F,
            0x0C,
            0x1F,
            0x35,
            0x2E,
            0x38,
            0x2E,
            0x30,
            0x2A,
            0x1F,
            0x0D,
            0x1F,
            0x36,
            0x2E,
            0x38,
            0x2E,
            0x30,
            0x2A,
            0x1F,
            0x0E,
            0x1F,
            0x37,
            0x2E,
            0x38,
            0x2E,
            0x30,
            0x2A,
            0x1F,
            0x0F,
            0x1F,
            0x38,
            0x2E,
            0x38,
            0x2E,
            0x30,
            0x2A,
            0x1F,
            0x10,
            0x1F,
            0x31,
            0x2E,
            0x36,
            0x2E,
            0x30,
            0x2A,
            0x1F,
            0x11,
            0x1F,
            0x32,
            0x2E,
            0x36,
            0x2E,
            0x30,
            0x2A,
            0x1F,
            0x12,
            0x1F,
            0x33,
            0x32,
            0x2E,
            0x37,
            0x2E,
            0x30,
            0x2A,
            0x1F,
            0x13,
            0x1F,
            0x35,
            0x32,
            0x2E,
            0x37,
            0x2E,
            0x30,
            0x2A,
            0x1F,
            0x14,
            0x1F,
            0x37,
            0x32,
            0x2E,
            0x37,
            0x2E,
            0x30,
            0x2A,
            0x1F,
            0x15,
            0x1F,
            0x33,
            0x31,
            0x2E,
            0x37,
            0x2E,
            0x30,
            0x2A,
            0x1F,
            0x16,
            0x1F,
            0x35,
            0x31,
            0x2E,
            0x37,
            0x2E,
            0x30,
            0x2A,
            0x1F,
            0x17,
            0x1F,
            0x37,
            0x31,
            0x2E,
            0x37,
            0x2E,
            0x30,
            0x2A,
            0x1F,
            0x18,
            0x1F,
            0x43,
            0x2E,
            0x31,
            0x2E,
            0x30,
            0x2A,
            0x1F,
          ]

      output:
        data:
          deviceID: 225208
          frameCounter: 0
          frameType: 'Status Message - OBIS'
          obisList:
            [
              [1, 'F.F*'],
              [2, '0.9.1*'],
              [3, '0.9.2*'],
              [4, '1.8.0*'],
              [5, '1.8.1*'],
              [6, '1.8.2*'],
              [7, '1.8.3*'],
              [8, '2.8.0*'],
              [9, '2.8.1*'],
              [10, '2.8.2*'],
              [11, '2.8.3*'],
              [12, '5.8.0*'],
              [13, '6.8.0*'],
              [14, '7.8.0*'],
              [15, '8.8.0*'],
              [16, '1.6.0*'],
              [17, '2.6.0*'],
              [18, '32.7.0*'],
              [19, '52.7.0*'],
              [20, '72.7.0*'],
              [21, '31.7.0*'],
              [22, '51.7.0*'],
              [23, '71.7.0*'],
              [24, 'C.1.0*'],
            ]

    - description: LKM LW example frame decode - Meter Response
      input:
        fPort: 3
        bytes:
          [
            0x00,
            0x03,
            0x6F,
            0xB8,
            0x02,
            0x01,
            0x01,
            0x60,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x01,
            0xE0,
            0x1F,
            0x00,
            0x03,
            0xAA,
            0xC2,
            0x00,
            0x16,
            0x2C,
            0xDA,
            0x00,
            0x16,
            0x2C,
            0xDA,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x89,
            0x96,
            0x00,
            0x00,
            0x89,
            0x96,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x09,
            0x47,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x00,
            0x04,
            0x0C,
            0xE1,
            0x65,
          ]

      output:
        data:
          dataLength: 96
          dataList: [[0], [122911], [240322], [1453274], [1453274], [0], [0], [35222], [35222], [0], [0], [0], [0], [0], [0], [0], [0], [2375], [0], [0], [0], [0], [0], [67952997]]
          deviceID: 225208
          frameCounter: 0
          frameType: 'Meter Response Message'
          meterNumber: 1
          obisStartNumber: 1
